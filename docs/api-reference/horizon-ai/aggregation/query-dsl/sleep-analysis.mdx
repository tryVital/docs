---
title: Sleep Analysis
description: Value macro expressions for Sleep Analysis
icon: moon
---


## Chronotype

Determine the chronotype of each sleep session.

<Accordion title="Output column name" icon="line-columns" iconType="duotone" defaultOpen>
`chronotype`
</Accordion>

### Get last chronotype of the week
<CodeGroup>
```python Python DSL
import vitalx.aggregation as va

va.select(
    va.Sleep.chronotype().latest()
).group_by(
    date_trunc(Sleep.index(), 1, "week")
)
```

```python JSON DSL
{
    "select": [
        { "func": "latest", "arg": { "value_macro": "chronotype" } }
    ],
    "group_by": [
        {
            "date_trunc": {
                "unit": "week",
                "value": 1
            }
        }
    ]
}
```
</CodeGroup>

### Get chronotype
<CodeGroup>
```python Python DSL
import vitalx.aggregation as va

va.select(va.Sleep.chronotype())
```

```python JSON DSL
{
    "select": [
        { "value_macro": "chronotype" }
    ]
}
```
</CodeGroup>



## Sleep Score

Calculate a Sleep Score (0 to 100) for each sleep session.

<Accordion title="Output column name" icon="line-columns" iconType="duotone" defaultOpen>
`sleep_score`
</Accordion>


### Get mean sleep score of the week
<CodeGroup>
```python Python DSL
import vitalx.aggregation as va

va.select(
    va.Sleep.score().mean()
).group_by(
    date_trunc(Sleep.index(), 1, "week")
)
```

```python JSON DSL
{
    "select": [
        { "func": "mean", "arg": { "value_macro": "sleep_score" } }
    ],
    "group_by": [
        {
            "date_trunc": {
                "unit": "week",
                "value": 1
            }
        }
    ]
}
```
</CodeGroup>

### Get sleep score

<CodeGroup>
```python Python DSL
import vitalx.aggregation as va

va.select(va.Sleep.score())
```

```python JSON DSL
{
    "select": [
        { "value_macro": "sleep_score" }
    ]
}
```
</CodeGroup>

## Awake At / Asleep At

Pinpoint when a user first fell asleep and when they became fully awake during each sleep session.

<Accordion title="Output column names" icon="line-columns" iconType="duotone" defaultOpen>
`asleep_at`, `awake_at`
</Accordion>

The `asleep_at` macro returns the bedtime start adjusted by the recorded sleep latency, while `awake_at` returns the bedtime start plus the offset of the final non-awake sleep segment.

### Get Asleep At and Awake At

<CodeGroup>
```python Python DSL
import vitalx.aggregation as va

va.select(
    va.Sleep.asleep_at(),
    va.Sleep.awake_at()
)
```

```python JSON DSL
{
    "select": [
        { "value_macro": "asleep_at" },
        { "value_macro": "awake_at" }
    ]
}
```
</CodeGroup>
