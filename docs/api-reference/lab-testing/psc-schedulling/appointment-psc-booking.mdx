---
openapi: "POST /v3/order/{order_id}/psc/appointment/book"
title: "Book PSC Appointment"
---

import FeatureBeta from '/snippets/feature-beta.mdx';


### Idempotency Key

<FeatureBeta />

When submitting a booking request, you can optionally specify an Idempotency Key. Requests sharing the same
Idempotency Key within a 14-day retention window would replay the initial request's response.

Note that the response is frozen once emitted. For example, assuming an initially pending appointment that
transitions to the confirmed status later on using Async Confirmation, the response with Idempotency Key will
continue to return the appointment at its initial pending status.


### Async Confirmation

<FeatureBeta />

Junction by default responds 500 Internal Server Error when the PSC Appointment Provider fails
to acknowledge the booking request.

With Async Confirmation, Junction synchronously waits for the provider to acknowledge the booking request,
up to the Sync Confirmation timeout (`sync_confirmation_timeout_millisecond`).

* If an acknowledgement is received before the timeout, Junction creates a _reserved or
  confirmed_ appointment immediately, and return it in the API endpoint response.

* If an acknowledgement has not yet been received upon the timeout, Junction creates a placeholder **pending**
  appointment, and return it in the API endpoint response.

If a pending appointment is created, Junction would continue to retry the booking request with the PSC
Appointment Provider in background, up to the Async Confirmation Timeout (`async_confirmation_timeout_millisecond`).

* If an acknowledgement is received before the timeout, the appointment transitions to either the _reserved or
  confirmed_ status.

* If the failure to acknowledge persists upon the timeout, the pending appointment transitions to the
  cancelled status.

You will receive the `labtest.appontment.updated` event for the initial appointment creation, as well as all
the state transitions as outlined above.


<RequestExample>
```bash cURL
curl --request POST \
     --url '{{BASE_URL}}/v3/order/413d7205-f8a9-42ed-aa4a-edb99e481ca0/psc/appointment/book' \
     --header 'accept: application/json' \
     --header 'x-vital-api-key: {YOUR_KEY}' \
     --data '
{
    "booking_key": "foo123"
}
'
```

```python Python
from vital.client import Vital
from vital.environment import VitalEnvironment

client = Vital(
  api_key="YOUR_API_KEY",
  environment=VitalEnvironment.SANDBOX
)

data = client.lab_tests.book_psc_appointment(order_id="<order_id>", booking_key="<booking_key>")
```

```javascript Node
import { VitalClient, VitalEnvironment } from '@tryvital/vital-node';
import { AppointmentBookingRequest } from '@tryvital/vital-node/api';

const client = new VitalClient({
    apiKey: '<my_api_key>',
    environment: VitalEnvironment.Sandbox,
});

const request: AppointmentBookingRequest = {
    bookingKey: "<booking_key>",
}
const data = await client.labTests.bookPscAppointment("<order_id>", request);
```


```java Java
import com.vital.api.Vital;
import com.vital.api.core.Environment;
import com.vital.api.resources.labtests.requests.AppointmentBookingRequest;

Vital vital = Vital.builder()
        .apiKey("YOUR_API_KEY")
        .environment(Environment.SANDBOX)
        .build();

AppointmentBookingRequest request = AppointmentBookingRequest
        .builder()
        .bookingKey("<booking_key>")
        .build();

var data = vital.labTests().bookPscAppointment("<order_id>", request);
```

```go Go
import (
  "context"

  vital "github.com/tryVital/vital-go"
  vitalclient "github.com/tryVital/vital-go/client"
  "github.com/tryVital/vital-go/option"
)

client := vitalclient.NewClient(
  option.WithApiKey("<YOUR_API_KEY>"),
  option.WithBaseURL(vital.Environments.Sandbox),
)

request := &vital.AppointmentBookingRequest{
    BookingKey: "<booking_key>",
}

response, err := client.LabTests.BookPscAppointment(context.TODO(), "<order_id>", request)
if err != nil {
    return err
}
fmt.Printf("Received data %s\n", response)
```

</RequestExample>

<ResponseExample>
```json Response
{
    "id": "413d7205-f8a9-42ed-aa4a-edb99e481ca0",
    "user_id": "202b2c2f-fb4c-44dc-a4f8-621186fde227",
    "address": {
        "first_line": "West Lincoln Street",
        "second_line": "",
        "city": "Phoenix",
        "state": "AZ",
        "zip_code": "85004",
        "unit": "14"
    },
    "location": {
        "lng": -112.0772235,
        "lat": 33.4421912
    },
    "start_at": "2023-05-15T16:00:00+00:00",
    "end_at": "2023-05-15T18:00:00+00:00",
    "iana_timezone": "America/Phoenix",
    "type": "patient_service_center",
    "provider": "quest",
    "status": "pending",
    "provider_id": "e89eb489-7382-4966-bb14-7ab4763eba6c",
    "can_reschedule": true,
    "external_id": "ABCDEF"
}
```
</ResponseExample>
